Switching logdir from './models/HUD/Indian_Pines_Corrected' to './experiments/results/HUD/Indian_Pines_Corrected'
{'model': {'base_learning_rate': 1e-06, 'target': 'ldm.models.diffusion.ddpm_HSI.LatentDiffusion', 'params': {'linear_start': 0.0015, 'linear_end': 0.0155, 'num_timesteps_cond': 1, 'log_every_t': 200, 'timesteps': 1000, 'loss_type': 'l2', 'first_stage_key': 'image', 'cond_stage_key': 'image', 'image_size': 32, 'channels': 16, 'cond_stage_trainable': False, 'concat_mode': False, 'scale_by_std': False, 'scale_factor': 10.0, 'monitor': 'val/loss_simple_ema', 'scheduler_config': {'target': 'ldm.lr_scheduler.LambdaLinearScheduler', 'params': {'warm_up_steps': [10000], 'cycle_lengths': [10000000000000], 'f_start': [1e-06], 'f_max': [1.0], 'f_min': [1.0]}}, 'unet_config': {'target': 'ldm.modules.diffusionmodules.openaimodel.UNetModel', 'params': {'image_size': 32, 'in_channels': 16, 'out_channels': 16, 'model_channels': 192, 'attention_resolutions': [1, 2, 4, 8], 'num_res_blocks': 2, 'channel_mult': [1, 2, 2, 4, 4], 'num_heads': 8, 'use_scale_shift_norm': True, 'resblock_updown': True}}, 'first_stage_config': {'target': 'ldm.models.hsi_encoder.VCA', 'params': {'in_channels': 200, 'out_channels': 16, 'ckpt_path': 'models/first_stage_models/HSI/VCA/Indian_Pines_Corrected/model.ckpt'}}, 'cond_stage_config': '__is_unconditional__'}}, 'data': {'target': 'main_HSI.DataModuleFromConfig', 'params': {'batch_size': 32, 'num_workers': 5, 'wrap': False, 'train': {'target': 'ldm.data.HSI.Indian_Pines_Corrected_train', 'params': {'size': 32}}, 'validation': {'target': 'ldm.data.HSI.Indian_Pines_Corrected_valid', 'params': {'size': 32}}}}}
Loading model from ./models/HUD/Indian_Pines_Corrected/model.ckpt
/data_ssy/latent-diffusion/scripts/param_count_HSI.py:271: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  pl_sd = torch.load(ckpt, map_location="cpu")
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 295.01 M params.
Keeping EMAs of 522.
/data_ssy/latent-diffusion/ldm/models/hsi_encoder.py:196: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sd = torch.load(path, map_location="cpu")["state_dict"]
Restored from models/first_stage_models/HSI/VCA/Indian_Pines_Corrected/model.ckpt
Training LatentDiffusion as an unconditional model.
global step: 16300
===========================================================================
logging to:
./experiments/results/HUD/Indian_Pines_Corrected
===========================================================================
{'dataset': 'Indian_Pines_Corrected', 'resume': './models/HUD/Indian_Pines_Corrected', 'n_samples': 4, 'eta': 1.0, 'vanilla_sample': False, 'logdir': './experiments/results/HUD', 'custom_steps': 250, 'batch_size': 4, 'base': ['./models/HUD/Indian_Pines_Corrected/config.yaml']}
?
Plotting: Switched to EMA weights
Data shape for DDIM sampling is (4, 16, 32, 32), eta 1.0
Running DDIM Sampling with 250 timesteps
DDIM Sampler:   0%|          | 0/250 [00:00<?, ?it/s]DDIM Sampler:   0%|          | 1/250 [00:00<01:45,  2.36it/s]DDIM Sampler:   1%|          | 3/250 [00:00<00:36,  6.76it/s]DDIM Sampler:   2%|▏         | 5/250 [00:00<00:24, 10.19it/s]DDIM Sampler:   3%|▎         | 7/250 [00:00<00:19, 12.73it/s]DDIM Sampler:   4%|▎         | 9/250 [00:00<00:16, 14.70it/s]DDIM Sampler:   4%|▍         | 11/250 [00:00<00:14, 16.10it/s]DDIM Sampler:   5%|▌         | 13/250 [00:01<00:13, 17.05it/s]DDIM Sampler:   6%|▌         | 15/250 [00:01<00:13, 17.77it/s]DDIM Sampler:   7%|▋         | 17/250 [00:01<00:12, 18.31it/s]DDIM Sampler:   8%|▊         | 19/250 [00:01<00:12, 18.71it/s]DDIM Sampler:   8%|▊         | 21/250 [00:01<00:12, 19.04it/s]DDIM Sampler:   9%|▉         | 23/250 [00:01<00:11, 19.22it/s]DDIM Sampler:  10%|█         | 25/250 [00:01<00:11, 19.32it/s]DDIM Sampler:  11%|█         | 27/250 [00:01<00:11, 19.44it/s]DDIM Sampler:  12%|█▏        | 29/250 [00:01<00:11, 19.54it/s]DDIM Sampler:  12%|█▏        | 31/250 [00:01<00:11, 19.66it/s]DDIM Sampler:  13%|█▎        | 33/250 [00:02<00:11, 19.65it/s]DDIM Sampler:  14%|█▍        | 35/250 [00:02<00:10, 19.61it/s]DDIM Sampler:  15%|█▍        | 37/250 [00:02<00:10, 19.64it/s]DDIM Sampler:  16%|█▌        | 39/250 [00:02<00:10, 19.71it/s]DDIM Sampler:  16%|█▋        | 41/250 [00:02<00:10, 19.71it/s]DDIM Sampler:  17%|█▋        | 43/250 [00:02<00:10, 19.59it/s]DDIM Sampler:  18%|█▊        | 45/250 [00:02<00:10, 19.57it/s]DDIM Sampler:  19%|█▉        | 47/250 [00:02<00:10, 19.63it/s]DDIM Sampler:  20%|█▉        | 49/250 [00:02<00:10, 19.52it/s]DDIM Sampler:  20%|██        | 51/250 [00:02<00:10, 19.63it/s]DDIM Sampler:  21%|██        | 53/250 [00:03<00:10, 19.64it/s]DDIM Sampler:  22%|██▏       | 55/250 [00:03<00:09, 19.57it/s]DDIM Sampler:  23%|██▎       | 57/250 [00:03<00:09, 19.49it/s]DDIM Sampler:  24%|██▎       | 59/250 [00:03<00:09, 19.62it/s]DDIM Sampler:  24%|██▍       | 61/250 [00:03<00:09, 19.65it/s]DDIM Sampler:  25%|██▌       | 63/250 [00:03<00:09, 19.71it/s]DDIM Sampler:  26%|██▌       | 65/250 [00:03<00:09, 19.65it/s]DDIM Sampler:  27%|██▋       | 67/250 [00:03<00:09, 19.59it/s]DDIM Sampler:  28%|██▊       | 69/250 [00:03<00:09, 19.46it/s]DDIM Sampler:  28%|██▊       | 71/250 [00:03<00:09, 19.48it/s]DDIM Sampler:  29%|██▉       | 73/250 [00:04<00:09, 19.46it/s]DDIM Sampler:  30%|███       | 75/250 [00:04<00:08, 19.46it/s]DDIM Sampler:  31%|███       | 77/250 [00:04<00:08, 19.43it/s]DDIM Sampler:  32%|███▏      | 79/250 [00:04<00:08, 19.59it/s]DDIM Sampler:  32%|███▏      | 81/250 [00:04<00:08, 19.52it/s]DDIM Sampler:  33%|███▎      | 83/250 [00:04<00:08, 19.64it/s]DDIM Sampler:  34%|███▍      | 85/250 [00:04<00:08, 19.62it/s]DDIM Sampler:  35%|███▍      | 87/250 [00:04<00:08, 19.62it/s]DDIM Sampler:  36%|███▌      | 89/250 [00:04<00:08, 19.06it/s]DDIM Sampler:  36%|███▋      | 91/250 [00:05<00:08, 18.94it/s]DDIM Sampler:  37%|███▋      | 93/250 [00:05<00:08, 19.01it/s]DDIM Sampler:  38%|███▊      | 95/250 [00:05<00:08, 19.04it/s]DDIM Sampler:  39%|███▉      | 97/250 [00:05<00:08, 19.06it/s]DDIM Sampler:  40%|███▉      | 99/250 [00:05<00:07, 19.12it/s]DDIM Sampler:  40%|████      | 101/250 [00:05<00:07, 19.26it/s]DDIM Sampler:  41%|████      | 103/250 [00:05<00:07, 19.25it/s]DDIM Sampler:  42%|████▏     | 105/250 [00:05<00:07, 19.22it/s]DDIM Sampler:  43%|████▎     | 107/250 [00:05<00:07, 19.20it/s]DDIM Sampler:  44%|████▎     | 109/250 [00:05<00:07, 19.23it/s]DDIM Sampler:  44%|████▍     | 111/250 [00:06<00:07, 19.15it/s]DDIM Sampler:  45%|████▌     | 113/250 [00:06<00:07, 19.15it/s]DDIM Sampler:  46%|████▌     | 115/250 [00:06<00:07, 19.03it/s]DDIM Sampler:  47%|████▋     | 117/250 [00:06<00:06, 19.06it/s]DDIM Sampler:  48%|████▊     | 119/250 [00:06<00:06, 19.05it/s]DDIM Sampler:  48%|████▊     | 121/250 [00:06<00:06, 19.20it/s]DDIM Sampler:  49%|████▉     | 123/250 [00:06<00:06, 19.14it/s]DDIM Sampler:  50%|█████     | 125/250 [00:06<00:06, 19.24it/s]DDIM Sampler:  51%|█████     | 127/250 [00:06<00:06, 19.19it/s]DDIM Sampler:  52%|█████▏    | 129/250 [00:07<00:06, 19.31it/s]DDIM Sampler:  52%|█████▏    | 131/250 [00:07<00:06, 19.24it/s]DDIM Sampler:  53%|█████▎    | 133/250 [00:07<00:06, 19.28it/s]DDIM Sampler:  54%|█████▍    | 135/250 [00:07<00:06, 19.16it/s]DDIM Sampler:  55%|█████▍    | 137/250 [00:07<00:05, 19.14it/s]DDIM Sampler:  56%|█████▌    | 139/250 [00:07<00:05, 18.92it/s]DDIM Sampler:  56%|█████▋    | 141/250 [00:07<00:05, 18.95it/s]DDIM Sampler:  57%|█████▋    | 143/250 [00:07<00:05, 18.95it/s]DDIM Sampler:  58%|█████▊    | 145/250 [00:07<00:05, 19.15it/s]DDIM Sampler:  59%|█████▉    | 147/250 [00:07<00:05, 19.19it/s]DDIM Sampler:  60%|█████▉    | 149/250 [00:08<00:05, 19.30it/s]DDIM Sampler:  60%|██████    | 151/250 [00:08<00:05, 19.26it/s]DDIM Sampler:  61%|██████    | 153/250 [00:08<00:05, 19.29it/s]DDIM Sampler:  62%|██████▏   | 155/250 [00:08<00:04, 19.30it/s]DDIM Sampler:  63%|██████▎   | 157/250 [00:08<00:04, 19.34it/s]DDIM Sampler:  64%|██████▎   | 159/250 [00:08<00:04, 19.25it/s]DDIM Sampler:  64%|██████▍   | 161/250 [00:08<00:04, 19.35it/s]DDIM Sampler:  65%|██████▌   | 163/250 [00:08<00:04, 19.29it/s]DDIM Sampler:  66%|██████▌   | 165/250 [00:08<00:04, 19.37it/s]DDIM Sampler:  67%|██████▋   | 167/250 [00:08<00:04, 19.33it/s]DDIM Sampler:  68%|██████▊   | 169/250 [00:09<00:04, 19.35it/s]DDIM Sampler:  68%|██████▊   | 171/250 [00:09<00:04, 19.31it/s]DDIM Sampler:  69%|██████▉   | 173/250 [00:09<00:03, 19.39it/s]DDIM Sampler:  70%|███████   | 175/250 [00:09<00:03, 19.32it/s]DDIM Sampler:  71%|███████   | 177/250 [00:09<00:03, 19.42it/s]DDIM Sampler:  72%|███████▏  | 179/250 [00:09<00:03, 19.45it/s]DDIM Sampler:  72%|███████▏  | 181/250 [00:09<00:03, 19.50it/s]DDIM Sampler:  73%|███████▎  | 183/250 [00:09<00:03, 19.38it/s]DDIM Sampler:  74%|███████▍  | 185/250 [00:09<00:03, 19.44it/s]DDIM Sampler:  75%|███████▍  | 187/250 [00:10<00:03, 19.35it/s]DDIM Sampler:  76%|███████▌  | 189/250 [00:10<00:03, 19.43it/s]DDIM Sampler:  76%|███████▋  | 191/250 [00:10<00:03, 19.40it/s]DDIM Sampler:  77%|███████▋  | 193/250 [00:10<00:02, 19.49it/s]DDIM Sampler:  78%|███████▊  | 195/250 [00:10<00:02, 19.48it/s]DDIM Sampler:  79%|███████▉  | 197/250 [00:10<00:02, 19.53it/s]DDIM Sampler:  80%|███████▉  | 199/250 [00:10<00:02, 19.47it/s]DDIM Sampler:  80%|████████  | 201/250 [00:10<00:02, 19.55it/s]DDIM Sampler:  81%|████████  | 203/250 [00:10<00:02, 19.44it/s]DDIM Sampler:  82%|████████▏ | 205/250 [00:10<00:02, 19.42it/s]DDIM Sampler:  83%|████████▎ | 207/250 [00:11<00:02, 19.34it/s]DDIM Sampler:  84%|████████▎ | 209/250 [00:11<00:02, 19.23it/s]DDIM Sampler:  84%|████████▍ | 211/250 [00:11<00:02, 18.61it/s]DDIM Sampler:  85%|████████▌ | 213/250 [00:11<00:02, 18.30it/s]DDIM Sampler:  86%|████████▌ | 215/250 [00:11<00:01, 18.05it/s]DDIM Sampler:  87%|████████▋ | 217/250 [00:11<00:01, 16.99it/s]DDIM Sampler:  88%|████████▊ | 219/250 [00:11<00:01, 17.20it/s]DDIM Sampler:  88%|████████▊ | 221/250 [00:11<00:01, 17.31it/s]DDIM Sampler:  89%|████████▉ | 223/250 [00:11<00:01, 17.49it/s]DDIM Sampler:  90%|█████████ | 225/250 [00:12<00:01, 17.86it/s]DDIM Sampler:  91%|█████████ | 227/250 [00:12<00:01, 18.35it/s]DDIM Sampler:  92%|█████████▏| 229/250 [00:12<00:01, 18.60it/s]DDIM Sampler:  92%|█████████▏| 231/250 [00:12<00:01, 18.85it/s]DDIM Sampler:  93%|█████████▎| 233/250 [00:12<00:00, 19.02it/s]DDIM Sampler:  94%|█████████▍| 235/250 [00:12<00:00, 19.15it/s]DDIM Sampler:  95%|█████████▍| 237/250 [00:12<00:00, 19.23it/s]DDIM Sampler:  96%|█████████▌| 239/250 [00:12<00:00, 19.26it/s]DDIM Sampler:  96%|█████████▋| 241/250 [00:12<00:00, 19.26it/s]DDIM Sampler:  97%|█████████▋| 243/250 [00:13<00:00, 19.33it/s]DDIM Sampler:  98%|█████████▊| 245/250 [00:13<00:00, 19.33it/s]DDIM Sampler:  99%|█████████▉| 247/250 [00:13<00:00, 19.42it/s]DDIM Sampler: 100%|█████████▉| 249/250 [00:13<00:00, 19.46it/s]DDIM Sampler: 100%|██████████| 250/250 [00:13<00:00, 18.71it/s]
Plotting: Restored training weights
Throughput for this batch: 0.2980726688506097
Memory allocated after forward: 3427.42 MB
/data_ssy/latent-diffusion/scripts/param_count_HSI.py:158: FutureWarning: `use_cuda` is deprecated, use `activities` argument instead
  with torch.profiler.profile(use_cuda=True) as prof:
Plotting: Switched to EMA weights
Data shape for DDIM sampling is (4, 16, 32, 32), eta 1.0
Running DDIM Sampling with 250 timesteps
DDIM Sampler:   0%|          | 0/250 [00:00<?, ?it/s]DDIM Sampler:   1%|          | 2/250 [00:00<00:19, 12.47it/s]DDIM Sampler:   2%|▏         | 4/250 [00:00<00:20, 12.29it/s]DDIM Sampler:   2%|▏         | 6/250 [00:00<00:19, 12.27it/s]DDIM Sampler:   3%|▎         | 8/250 [00:00<00:19, 12.33it/s]DDIM Sampler:   4%|▍         | 10/250 [00:00<00:19, 12.39it/s]DDIM Sampler:   5%|▍         | 12/250 [00:00<00:19, 12.42it/s]DDIM Sampler:   6%|▌         | 14/250 [00:01<00:19, 12.42it/s]DDIM Sampler:   6%|▋         | 16/250 [00:01<00:18, 12.38it/s]DDIM Sampler:   7%|▋         | 18/250 [00:01<00:18, 12.40it/s]DDIM Sampler:   8%|▊         | 20/250 [00:01<00:18, 12.42it/s]DDIM Sampler:   9%|▉         | 22/250 [00:01<00:18, 12.37it/s]DDIM Sampler:  10%|▉         | 24/250 [00:01<00:18, 12.41it/s]DDIM Sampler:  10%|█         | 26/250 [00:02<00:18, 12.29it/s]DDIM Sampler:  11%|█         | 28/250 [00:02<00:18, 12.33it/s]DDIM Sampler:  12%|█▏        | 30/250 [00:02<00:17, 12.33it/s]DDIM Sampler:  13%|█▎        | 32/250 [00:02<00:17, 12.36it/s]DDIM Sampler:  14%|█▎        | 34/250 [00:02<00:17, 12.37it/s]DDIM Sampler:  14%|█▍        | 36/250 [00:02<00:17, 12.29it/s]DDIM Sampler:  15%|█▌        | 38/250 [00:03<00:17, 12.39it/s]DDIM Sampler:  16%|█▌        | 40/250 [00:03<00:16, 12.41it/s]DDIM Sampler:  17%|█▋        | 42/250 [00:03<00:16, 12.41it/s]DDIM Sampler:  18%|█▊        | 44/250 [00:03<00:16, 12.40it/s]DDIM Sampler:  18%|█▊        | 46/250 [00:03<00:16, 12.40it/s]DDIM Sampler:  19%|█▉        | 48/250 [00:03<00:16, 12.41it/s]DDIM Sampler:  20%|██        | 50/250 [00:04<00:16, 12.43it/s]DDIM Sampler:  21%|██        | 52/250 [00:04<00:15, 12.46it/s]DDIM Sampler:  22%|██▏       | 54/250 [00:04<00:15, 12.41it/s]DDIM Sampler:  22%|██▏       | 56/250 [00:04<00:15, 12.31it/s]DDIM Sampler:  23%|██▎       | 58/250 [00:04<00:15, 12.26it/s]DDIM Sampler:  24%|██▍       | 60/250 [00:04<00:15, 12.33it/s]DDIM Sampler:  25%|██▍       | 62/250 [00:05<00:15, 12.30it/s]DDIM Sampler:  26%|██▌       | 64/250 [00:05<00:14, 12.41it/s]DDIM Sampler:  26%|██▋       | 66/250 [00:05<00:14, 12.37it/s]DDIM Sampler:  27%|██▋       | 68/250 [00:05<00:14, 12.37it/s]DDIM Sampler:  28%|██▊       | 70/250 [00:05<00:14, 12.36it/s]DDIM Sampler:  29%|██▉       | 72/250 [00:05<00:14, 12.31it/s]DDIM Sampler:  30%|██▉       | 74/250 [00:05<00:14, 12.36it/s]DDIM Sampler:  30%|███       | 76/250 [00:06<00:14, 12.33it/s]DDIM Sampler:  31%|███       | 78/250 [00:06<00:13, 12.41it/s]DDIM Sampler:  32%|███▏      | 80/250 [00:06<00:13, 12.37it/s]DDIM Sampler:  33%|███▎      | 82/250 [00:06<00:13, 12.42it/s]DDIM Sampler:  34%|███▎      | 84/250 [00:06<00:13, 12.45it/s]DDIM Sampler:  34%|███▍      | 86/250 [00:06<00:13, 12.47it/s]DDIM Sampler:  35%|███▌      | 88/250 [00:07<00:13, 12.44it/s]DDIM Sampler:  36%|███▌      | 90/250 [00:07<00:12, 12.43it/s]DDIM Sampler:  37%|███▋      | 92/250 [00:07<00:12, 12.44it/s]DDIM Sampler:  38%|███▊      | 94/250 [00:07<00:12, 12.41it/s]DDIM Sampler:  38%|███▊      | 96/250 [00:07<00:12, 12.41it/s]DDIM Sampler:  39%|███▉      | 98/250 [00:07<00:12, 12.33it/s]DDIM Sampler:  40%|████      | 100/250 [00:08<00:12, 12.36it/s]DDIM Sampler:  41%|████      | 102/250 [00:08<00:11, 12.35it/s]DDIM Sampler:  42%|████▏     | 104/250 [00:08<00:11, 12.30it/s]DDIM Sampler:  42%|████▏     | 106/250 [00:08<00:11, 12.31it/s]DDIM Sampler:  43%|████▎     | 108/250 [00:08<00:11, 12.27it/s]DDIM Sampler:  44%|████▍     | 110/250 [00:08<00:11, 12.33it/s]DDIM Sampler:  45%|████▍     | 112/250 [00:09<00:11, 12.27it/s]DDIM Sampler:  46%|████▌     | 114/250 [00:09<00:11, 12.28it/s]DDIM Sampler:  46%|████▋     | 116/250 [00:09<00:10, 12.20it/s]DDIM Sampler:  47%|████▋     | 118/250 [00:09<00:10, 12.22it/s]DDIM Sampler:  48%|████▊     | 120/250 [00:09<00:10, 12.20it/s]DDIM Sampler:  49%|████▉     | 122/250 [00:09<00:10, 12.21it/s]DDIM Sampler:  50%|████▉     | 124/250 [00:10<00:10, 12.20it/s]DDIM Sampler:  50%|█████     | 126/250 [00:10<00:10, 12.39it/s]DDIM Sampler:  51%|█████     | 128/250 [00:10<00:09, 12.67it/s]DDIM Sampler:  52%|█████▏    | 130/250 [00:10<00:09, 12.82it/s]DDIM Sampler:  53%|█████▎    | 132/250 [00:10<00:09, 12.95it/s]DDIM Sampler:  54%|█████▎    | 134/250 [00:10<00:08, 13.02it/s]DDIM Sampler:  54%|█████▍    | 136/250 [00:10<00:08, 13.10it/s]DDIM Sampler:  55%|█████▌    | 138/250 [00:11<00:08, 13.15it/s]DDIM Sampler:  56%|█████▌    | 140/250 [00:11<00:08, 13.20it/s]DDIM Sampler:  57%|█████▋    | 142/250 [00:11<00:08, 13.18it/s]DDIM Sampler:  58%|█████▊    | 144/250 [00:11<00:08, 13.21it/s]DDIM Sampler:  58%|█████▊    | 146/250 [00:11<00:07, 13.28it/s]DDIM Sampler:  59%|█████▉    | 148/250 [00:11<00:08, 11.60it/s]DDIM Sampler:  60%|██████    | 150/250 [00:12<00:10,  9.82it/s]DDIM Sampler:  61%|██████    | 152/250 [00:12<00:10,  9.79it/s]DDIM Sampler:  62%|██████▏   | 154/250 [00:12<00:09,  9.93it/s]DDIM Sampler:  62%|██████▏   | 156/250 [00:12<00:09, 10.20it/s]DDIM Sampler:  63%|██████▎   | 158/250 [00:12<00:08, 10.54it/s]DDIM Sampler:  64%|██████▍   | 160/250 [00:13<00:08, 10.86it/s]DDIM Sampler:  65%|██████▍   | 162/250 [00:13<00:07, 11.14it/s]DDIM Sampler:  66%|██████▌   | 164/250 [00:13<00:07, 11.34it/s]DDIM Sampler:  66%|██████▋   | 166/250 [00:13<00:07, 11.11it/s]DDIM Sampler:  67%|██████▋   | 168/250 [00:13<00:07, 11.26it/s]DDIM Sampler:  68%|██████▊   | 170/250 [00:13<00:06, 11.50it/s]DDIM Sampler:  69%|██████▉   | 172/250 [00:14<00:06, 11.78it/s]DDIM Sampler:  70%|██████▉   | 174/250 [00:14<00:06, 11.87it/s]DDIM Sampler:  70%|███████   | 176/250 [00:14<00:06, 11.93it/s]DDIM Sampler:  71%|███████   | 178/250 [00:14<00:06, 11.99it/s]DDIM Sampler:  72%|███████▏  | 180/250 [00:14<00:05, 11.98it/s]DDIM Sampler:  73%|███████▎  | 182/250 [00:14<00:05, 12.06it/s]DDIM Sampler:  74%|███████▎  | 184/250 [00:15<00:05, 12.05it/s]DDIM Sampler:  74%|███████▍  | 186/250 [00:15<00:05, 12.07it/s]DDIM Sampler:  75%|███████▌  | 188/250 [00:15<00:05, 12.08it/s]DDIM Sampler:  76%|███████▌  | 190/250 [00:15<00:04, 12.18it/s]DDIM Sampler:  77%|███████▋  | 192/250 [00:15<00:04, 12.21it/s]DDIM Sampler:  78%|███████▊  | 194/250 [00:15<00:04, 12.18it/s]DDIM Sampler:  78%|███████▊  | 196/250 [00:16<00:04, 12.13it/s]DDIM Sampler:  79%|███████▉  | 198/250 [00:16<00:04, 12.07it/s]DDIM Sampler:  80%|████████  | 200/250 [00:16<00:04, 12.13it/s]DDIM Sampler:  81%|████████  | 202/250 [00:16<00:03, 12.16it/s]DDIM Sampler:  82%|████████▏ | 204/250 [00:16<00:03, 12.16it/s]DDIM Sampler:  82%|████████▏ | 206/250 [00:16<00:03, 12.19it/s]DDIM Sampler:  83%|████████▎ | 208/250 [00:17<00:03, 12.15it/s]DDIM Sampler:  84%|████████▍ | 210/250 [00:17<00:03, 12.08it/s]DDIM Sampler:  85%|████████▍ | 212/250 [00:17<00:03, 12.06it/s]DDIM Sampler:  86%|████████▌ | 214/250 [00:17<00:02, 12.08it/s]DDIM Sampler:  86%|████████▋ | 216/250 [00:17<00:02, 11.99it/s]DDIM Sampler:  87%|████████▋ | 218/250 [00:17<00:02, 11.75it/s]DDIM Sampler:  88%|████████▊ | 220/250 [00:18<00:02, 11.52it/s]DDIM Sampler:  89%|████████▉ | 222/250 [00:18<00:02, 11.37it/s]DDIM Sampler:  90%|████████▉ | 224/250 [00:18<00:02, 11.29it/s]DDIM Sampler:  90%|█████████ | 226/250 [00:18<00:02, 11.30it/s]DDIM Sampler:  91%|█████████ | 228/250 [00:18<00:01, 11.54it/s]DDIM Sampler:  92%|█████████▏| 230/250 [00:19<00:01, 11.72it/s]DDIM Sampler:  93%|█████████▎| 232/250 [00:19<00:01, 11.83it/s]DDIM Sampler:  94%|█████████▎| 234/250 [00:19<00:01, 11.86it/s]DDIM Sampler:  94%|█████████▍| 236/250 [00:19<00:01, 11.96it/s]DDIM Sampler:  95%|█████████▌| 238/250 [00:19<00:01, 11.97it/s]DDIM Sampler:  96%|█████████▌| 240/250 [00:19<00:00, 12.06it/s]DDIM Sampler:  97%|█████████▋| 242/250 [00:20<00:00, 12.02it/s]DDIM Sampler:  98%|█████████▊| 244/250 [00:20<00:00, 12.10it/s]DDIM Sampler:  98%|█████████▊| 246/250 [00:20<00:00, 12.05it/s]DDIM Sampler:  99%|█████████▉| 248/250 [00:20<00:00, 12.11it/s]DDIM Sampler: 100%|██████████| 250/250 [00:20<00:00, 12.14it/s]DDIM Sampler: 100%|██████████| 250/250 [00:20<00:00, 12.09it/s]
Plotting: Restored training weights
Throughput for this batch: 0.19347131680219845
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                aten::cudnn_convolution        11.39%        1.791s        18.17%        2.857s      87.249us        1.816s        56.44%        1.816s      55.461us         32750  
sm86_xmma_fprop_implicit_gemm_tf32f32_tf32f32_f32_nh...         0.00%       0.000us         0.00%       0.000us       0.000us     659.005ms        20.48%     659.005ms     105.441us          6250  
                                              aten::bmm         2.47%     388.354ms         3.42%     537.635ms      51.203us     490.347ms        15.24%     490.347ms      46.700us         10500  
void cudnn::engines_precompiled::nchwToNhwcKernel<fl...         0.00%       0.000us         0.00%       0.000us       0.000us     430.312ms        13.37%     430.312ms      12.121us         35500  
                                         aten::_softmax         0.71%     111.255ms         1.14%     179.213ms      34.136us     384.232ms        11.94%     384.232ms      73.187us          5250  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us     371.748ms        11.55%     371.748ms     297.399us          1250  
                                ampere_sgemm_128x128_tn         0.00%       0.000us         0.00%       0.000us       0.000us     291.760ms         9.07%     291.760ms      77.803us          3750  
void cutlass::Kernel<cutlass_80_tensorop_s1688gemm_6...         0.00%       0.000us         0.00%       0.000us       0.000us     225.772ms         7.02%     225.772ms      15.307us         14750  
                                ampere_sgemm_128x128_nt         0.00%       0.000us         0.00%       0.000us       0.000us     194.149ms         6.03%     194.149ms      36.981us          5250  
sm86_xmma_fprop_implicit_gemm_tf32f32_tf32f32_f32_nh...         0.00%       0.000us         0.00%       0.000us       0.000us     182.224ms         5.66%     182.224ms      45.556us          4000  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 15.729s
Self CUDA time total: 3.218s

+++++
Traceback (most recent call last):
  File "/home/home_node6_1/ssy1/anaconda3/envs/ldm/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/home_node6_1/ssy1/anaconda3/envs/ldm/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/data_ssy/latent-diffusion/scripts/param_count_HSI.py", line 351, in <module>
    run(opt.dataset, model, logdir, eta=opt.eta,
  File "/data_ssy/latent-diffusion/scripts/param_count_HSI.py", line 162, in run
    prof.key_averages().print()
AttributeError: 'EventList' object has no attribute 'print'
