Args:
	batch_size: 32
	checkpoint_dir: ./experiments/metric/checkpoints
	datasets: ['Indian_Pines_Corrected', 'KSC_Corrected', 'Pavia', 'PaviaU', 'Salinas_Corrected']
	embedding_dim: 256
	epochs: 50
	hidden_dim: 64
	image_size: 32
	layers: 16
	load_checkpoint: False
	lr: 0.0001
	save_checkpoint: True
Start training Indian_Pines_Corrected dataset
Epoch [1/50], Step [325/325], train_loss: 0.0979, train_acc: 0.6821, valid_loss: 0.1183, valid_acc: 0.5815
Epoch [2/50], Step [325/325], train_loss: 0.0381, train_acc: 0.8347, valid_loss: 0.1268, valid_acc: 0.5982
Epoch [3/50], Step [325/325], train_loss: 0.0220, train_acc: 0.8698, valid_loss: 0.1235, valid_acc: 0.6066
Epoch [4/50], Step [325/325], train_loss: 0.0149, train_acc: 0.8830, valid_loss: 0.1097, valid_acc: 0.6461
Epoch [5/50], Step [325/325], train_loss: 0.0127, train_acc: 0.8856, valid_loss: 0.1280, valid_acc: 0.6238
Epoch [6/50], Step [325/325], train_loss: 0.0108, train_acc: 0.8885, valid_loss: 0.1359, valid_acc: 0.6344
Epoch [7/50], Step [325/325], train_loss: 0.0100, train_acc: 0.8885, valid_loss: 0.1230, valid_acc: 0.6748
Epoch [8/50], Step [325/325], train_loss: 0.0095, train_acc: 0.8903, valid_loss: 0.1213, valid_acc: 0.8051
Epoch [9/50], Step [325/325], train_loss: 0.0093, train_acc: 0.8929, valid_loss: 0.1527, valid_acc: 0.6585
Epoch [10/50], Step [325/325], train_loss: 0.0091, train_acc: 0.8945, valid_loss: 0.1237, valid_acc: 0.6804
Epoch [11/50], Step [325/325], train_loss: 0.0089, train_acc: 0.8989, valid_loss: 0.1235, valid_acc: 0.6705
Epoch [12/50], Step [325/325], train_loss: 0.0082, train_acc: 0.9065, valid_loss: 0.1064, valid_acc: 0.7257
Epoch [13/50], Step [325/325], train_loss: 0.0085, train_acc: 0.9104, valid_loss: 0.1744, valid_acc: 0.6112
Epoch [14/50], Step [325/325], train_loss: 0.0082, train_acc: 0.9213, valid_loss: 0.1092, valid_acc: 0.7295
Epoch [15/50], Step [325/325], train_loss: 0.0088, train_acc: 0.9238, valid_loss: 0.1521, valid_acc: 0.6690
Epoch [16/50], Step [325/325], train_loss: 0.0083, train_acc: 0.9401, valid_loss: 0.1361, valid_acc: 0.8053
Epoch [17/50], Step [325/325], train_loss: 0.0081, train_acc: 0.9482, valid_loss: 0.1461, valid_acc: 0.7734
Epoch [18/50], Step [325/325], train_loss: 0.0079, train_acc: 0.9583, valid_loss: 0.1456, valid_acc: 0.6886
Epoch [19/50], Step [325/325], train_loss: 0.0082, train_acc: 0.9591, valid_loss: 0.1720, valid_acc: 0.7457
Epoch [20/50], Step [325/325], train_loss: 0.0092, train_acc: 0.9406, valid_loss: 0.1126, valid_acc: 0.8177
Epoch [21/50], Step [325/325], train_loss: 0.0080, train_acc: 0.9597, valid_loss: 0.1223, valid_acc: 0.8428
Epoch [22/50], Step [325/325], train_loss: 0.0078, train_acc: 0.9675, valid_loss: 0.1251, valid_acc: 0.8256
Epoch [23/50], Step [325/325], train_loss: 0.0081, train_acc: 0.9681, valid_loss: 0.1196, valid_acc: 0.8384
Epoch [24/50], Step [325/325], train_loss: 0.0080, train_acc: 0.9689, valid_loss: 0.1702, valid_acc: 0.6046
Epoch [25/50], Step [325/325], train_loss: 0.0083, train_acc: 0.9637, valid_loss: 0.1629, valid_acc: 0.7786
Epoch [26/50], Step [325/325], train_loss: 0.0078, train_acc: 0.9729, valid_loss: 0.1388, valid_acc: 0.8152
Epoch [27/50], Step [325/325], train_loss: 0.0086, train_acc: 0.9613, valid_loss: 0.1567, valid_acc: 0.7817
Epoch [28/50], Step [325/325], train_loss: 0.0075, train_acc: 0.9775, valid_loss: 0.1302, valid_acc: 0.8411
Epoch [29/50], Step [325/325], train_loss: 0.0087, train_acc: 0.9593, valid_loss: 0.1341, valid_acc: 0.8093
Epoch [30/50], Step [325/325], train_loss: 0.0079, train_acc: 0.9695, valid_loss: 0.1301, valid_acc: 0.8237
Epoch [31/50], Step [325/325], train_loss: 0.0079, train_acc: 0.9714, valid_loss: 0.1526, valid_acc: 0.7687
Epoch [32/50], Step [325/325], train_loss: 0.0082, train_acc: 0.9649, valid_loss: 0.1244, valid_acc: 0.8449
Epoch [33/50], Step [325/325], train_loss: 0.0078, train_acc: 0.9708, valid_loss: 0.1434, valid_acc: 0.7911
Epoch [34/50], Step [325/325], train_loss: 0.0079, train_acc: 0.9654, valid_loss: 0.1759, valid_acc: 0.7496
Epoch [35/50], Step [325/325], train_loss: 0.0080, train_acc: 0.9632, valid_loss: 0.1467, valid_acc: 0.7985
Epoch [36/50], Step [325/325], train_loss: 0.0081, train_acc: 0.9622, valid_loss: 0.1447, valid_acc: 0.8023
Epoch [37/50], Step [325/325], train_loss: 0.0083, train_acc: 0.9554, valid_loss: 0.1968, valid_acc: 0.7028
Epoch [38/50], Step [325/325], train_loss: 0.0077, train_acc: 0.9684, valid_loss: 0.1488, valid_acc: 0.7980
Epoch [39/50], Step [325/325], train_loss: 0.0079, train_acc: 0.9644, valid_loss: 0.1349, valid_acc: 0.8314
Epoch [40/50], Step [325/325], train_loss: 0.0087, train_acc: 0.9527, valid_loss: 0.1801, valid_acc: 0.7438
Epoch [41/50], Step [325/325], train_loss: 0.0076, train_acc: 0.9631, valid_loss: 0.1211, valid_acc: 0.8522
Epoch [42/50], Step [325/325], train_loss: 0.0080, train_acc: 0.9648, valid_loss: 0.1778, valid_acc: 0.7522
Epoch [43/50], Step [325/325], train_loss: 0.0078, train_acc: 0.9631, valid_loss: 0.1315, valid_acc: 0.8382
Epoch [44/50], Step [325/325], train_loss: 0.0077, train_acc: 0.9694, valid_loss: 0.1532, valid_acc: 0.7973
Epoch [45/50], Step [325/325], train_loss: 0.0080, train_acc: 0.9604, valid_loss: 0.1812, valid_acc: 0.7439
Epoch [46/50], Step [325/325], train_loss: 0.0077, train_acc: 0.9665, valid_loss: 0.1525, valid_acc: 0.7905
Epoch [47/50], Step [325/325], train_loss: 0.0079, train_acc: 0.9628, valid_loss: 0.1422, valid_acc: 0.7764
Epoch [48/50], Step [325/325], train_loss: 0.0083, train_acc: 0.9550, valid_loss: 0.1389, valid_acc: 0.8299
Epoch [49/50], Step [325/325], train_loss: 0.0076, train_acc: 0.9696, valid_loss: 0.2000, valid_acc: 0.7215
Epoch [50/50], Step [325/325], train_loss: 0.0080, train_acc: 0.9542, valid_loss: 0.1648, valid_acc: 0.7986
Finish training Indian_Pines_Corrected dataset
Save checkpoint to ./experiments/metric/checkpoints/classifier/Indian_Pines_Corrected
Start training KSC_Corrected dataset
Epoch [1/50], Step [7011/7011], train_loss: 0.0261, train_acc: 0.8668, valid_loss: 0.0258, valid_acc: 0.8658
Epoch [2/50], Step [7011/7011], train_loss: 0.0160, train_acc: 0.9378, valid_loss: 0.0315, valid_acc: 0.9822
Epoch [3/50], Step [7011/7011], train_loss: 0.0145, train_acc: 0.9862, valid_loss: 0.0313, valid_acc: 0.9806
Epoch [4/50], Step [7011/7011], train_loss: 0.0133, train_acc: 0.9829, valid_loss: 0.0284, valid_acc: 0.8640
Epoch [5/50], Step [7011/7011], train_loss: 0.0121, train_acc: 0.9657, valid_loss: 0.0781, valid_acc: 0.9799
Epoch [6/50], Step [7011/7011], train_loss: 0.0114, train_acc: 0.9512, valid_loss: 0.0303, valid_acc: 0.8614
Epoch [7/50], Step [7011/7011], train_loss: 0.0110, train_acc: 0.9552, valid_loss: 0.0760, valid_acc: 0.9808
Epoch [8/50], Step [7011/7011], train_loss: 0.0109, train_acc: 0.9579, valid_loss: 0.0807, valid_acc: 0.9804
Epoch [9/50], Step [7011/7011], train_loss: 0.0107, train_acc: 0.9623, valid_loss: 0.0800, valid_acc: 0.9809
Epoch [10/50], Step [7011/7011], train_loss: 0.0114, train_acc: 0.9522, valid_loss: 0.0465, valid_acc: 0.9791
Epoch [11/50], Step [7011/7011], train_loss: 0.0106, train_acc: 0.9616, valid_loss: 0.0302, valid_acc: 0.9776
Epoch [12/50], Step [7011/7011], train_loss: 0.0105, train_acc: 0.9643, valid_loss: 0.0295, valid_acc: 0.9806
Epoch [13/50], Step [7011/7011], train_loss: 0.0104, train_acc: 0.9639, valid_loss: 0.0793, valid_acc: 0.9796
Epoch [14/50], Step [7011/7011], train_loss: 0.0102, train_acc: 0.9599, valid_loss: 0.0806, valid_acc: 0.9812
Epoch [15/50], Step [7011/7011], train_loss: 0.0099, train_acc: 0.9552, valid_loss: 0.0793, valid_acc: 0.9803
Epoch [16/50], Step [7011/7011], train_loss: 0.0113, train_acc: 0.9541, valid_loss: 0.0287, valid_acc: 0.9793
Epoch [17/50], Step [7011/7011], train_loss: 0.0096, train_acc: 0.9541, valid_loss: 0.0794, valid_acc: 0.9818
Epoch [18/50], Step [7011/7011], train_loss: 0.0094, train_acc: 0.9518, valid_loss: 0.0391, valid_acc: 0.8638
Epoch [19/50], Step [7011/7011], train_loss: 0.0094, train_acc: 0.9534, valid_loss: 0.0815, valid_acc: 0.9775
Epoch [20/50], Step [7011/7011], train_loss: 0.0099, train_acc: 0.9559, valid_loss: 0.0795, valid_acc: 0.9786
Epoch [21/50], Step [7011/7011], train_loss: 0.0094, train_acc: 0.9563, valid_loss: 0.0395, valid_acc: 0.8629
Epoch [22/50], Step [7011/7011], train_loss: 0.0093, train_acc: 0.9570, valid_loss: 0.0312, valid_acc: 0.8630
Epoch [23/50], Step [7011/7011], train_loss: 0.0093, train_acc: 0.9585, valid_loss: 0.0302, valid_acc: 0.9791
Epoch [24/50], Step [7011/7011], train_loss: 0.0093, train_acc: 0.9568, valid_loss: 0.0337, valid_acc: 0.9807
Epoch [25/50], Step [7011/7011], train_loss: 0.0093, train_acc: 0.9583, valid_loss: 0.0417, valid_acc: 0.9746
Epoch [26/50], Step [7011/7011], train_loss: 0.0108, train_acc: 0.9646, valid_loss: 0.0264, valid_acc: 0.9821
Epoch [27/50], Step [7011/7011], train_loss: 0.0136, train_acc: 0.9862, valid_loss: 0.0409, valid_acc: 0.9743
Epoch [28/50], Step [7011/7011], train_loss: 0.0107, train_acc: 0.9715, valid_loss: 0.0701, valid_acc: 0.9791
Epoch [29/50], Step [7011/7011], train_loss: 0.0097, train_acc: 0.9569, valid_loss: 0.0787, valid_acc: 0.9789
Epoch [30/50], Step [7011/7011], train_loss: 0.0095, train_acc: 0.9535, valid_loss: 0.0792, valid_acc: 0.9809
Epoch [31/50], Step [7011/7011], train_loss: 0.0094, train_acc: 0.9530, valid_loss: 0.0801, valid_acc: 0.9768
Epoch [32/50], Step [7011/7011], train_loss: 0.0093, train_acc: 0.9535, valid_loss: 0.0802, valid_acc: 0.9802
Epoch [33/50], Step [7011/7011], train_loss: 0.0093, train_acc: 0.9543, valid_loss: 0.0800, valid_acc: 0.9800
Epoch [34/50], Step [7011/7011], train_loss: 0.0093, train_acc: 0.9542, valid_loss: 0.0815, valid_acc: 0.9795
Epoch [35/50], Step [7011/7011], train_loss: 0.0093, train_acc: 0.9545, valid_loss: 0.0416, valid_acc: 0.9800
Epoch [36/50], Step [7011/7011], train_loss: 0.0092, train_acc: 0.9534, valid_loss: 0.0794, valid_acc: 0.9790
Epoch [37/50], Step [7011/7011], train_loss: 0.0092, train_acc: 0.9531, valid_loss: 0.0773, valid_acc: 0.9794
Epoch [38/50], Step [7011/7011], train_loss: 0.0092, train_acc: 0.9540, valid_loss: 0.0818, valid_acc: 0.9778
Epoch [39/50], Step [7011/7011], train_loss: 0.0092, train_acc: 0.9513, valid_loss: 0.0791, valid_acc: 0.9801
Epoch [40/50], Step [7011/7011], train_loss: 0.0092, train_acc: 0.9518, valid_loss: 0.0585, valid_acc: 0.9796
Epoch [41/50], Step [7011/7011], train_loss: 0.0092, train_acc: 0.9533, valid_loss: 0.0285, valid_acc: 0.9815
Epoch [42/50], Step [7011/7011], train_loss: 0.0094, train_acc: 0.9521, valid_loss: 0.0809, valid_acc: 0.9813
Epoch [43/50], Step [7011/7011], train_loss: 0.0092, train_acc: 0.9534, valid_loss: 0.0820, valid_acc: 0.9790
Epoch [44/50], Step [7011/7011], train_loss: 0.0092, train_acc: 0.9523, valid_loss: 0.0284, valid_acc: 0.9823
Epoch [45/50], Step [7011/7011], train_loss: 0.0092, train_acc: 0.9540, valid_loss: 0.0774, valid_acc: 0.9805
Epoch [46/50], Step [7011/7011], train_loss: 0.0092, train_acc: 0.9523, valid_loss: 0.0683, valid_acc: 0.9793
Epoch [47/50], Step [7011/7011], train_loss: 0.0092, train_acc: 0.9546, valid_loss: 0.0285, valid_acc: 0.9820
Epoch [48/50], Step [7011/7011], train_loss: 0.0091, train_acc: 0.9555, valid_loss: 0.0768, valid_acc: 0.9783
Epoch [49/50], Step [7011/7011], train_loss: 0.0092, train_acc: 0.9549, valid_loss: 0.0787, valid_acc: 0.9812
Epoch [50/50], Step [7011/7011], train_loss: 0.0111, train_acc: 0.9605, valid_loss: 0.0266, valid_acc: 0.9820
Finish training KSC_Corrected dataset
Save checkpoint to ./experiments/metric/checkpoints/classifier/KSC_Corrected
Start training Pavia dataset
Epoch [1/50], Step [18212/18212], train_loss: 0.0561, train_acc: 0.7991, valid_loss: 0.0610, valid_acc: 0.9320
Epoch [2/50], Step [18212/18212], train_loss: 0.0336, train_acc: 0.8776, valid_loss: 0.0889, valid_acc: 0.9379
Epoch [3/50], Step [18212/18212], train_loss: 0.0256, train_acc: 0.9049, valid_loss: 0.0705, valid_acc: 0.8170
Epoch [4/50], Step [18212/18212], train_loss: 0.0222, train_acc: 0.9089, valid_loss: 0.0729, valid_acc: 0.8183
Epoch [5/50], Step [18212/18212], train_loss: 0.0205, train_acc: 0.9115, valid_loss: 0.0844, valid_acc: 0.8083
Epoch [6/50], Step [18212/18212], train_loss: 0.0192, train_acc: 0.9156, valid_loss: 0.0748, valid_acc: 0.8152
Epoch [7/50], Step [18212/18212], train_loss: 0.0178, train_acc: 0.9230, valid_loss: 0.0772, valid_acc: 0.9369
Epoch [8/50], Step [18212/18212], train_loss: 0.0167, train_acc: 0.9289, valid_loss: 0.0861, valid_acc: 0.8178
Epoch [9/50], Step [18212/18212], train_loss: 0.0162, train_acc: 0.9339, valid_loss: 0.1207, valid_acc: 0.9287
Epoch [10/50], Step [18212/18212], train_loss: 0.0161, train_acc: 0.9379, valid_loss: 0.0822, valid_acc: 0.9304
Epoch [11/50], Step [18212/18212], train_loss: 0.0158, train_acc: 0.9415, valid_loss: 0.0818, valid_acc: 0.9337
Epoch [12/50], Step [18212/18212], train_loss: 0.0157, train_acc: 0.9393, valid_loss: 0.0829, valid_acc: 0.8172
Epoch [13/50], Step [18212/18212], train_loss: 0.0215, train_acc: 0.9315, valid_loss: 0.0810, valid_acc: 0.9355
Epoch [14/50], Step [18212/18212], train_loss: 0.0155, train_acc: 0.9389, valid_loss: 0.0811, valid_acc: 0.9339
Epoch [15/50], Step [18212/18212], train_loss: 0.0154, train_acc: 0.9418, valid_loss: 0.1288, valid_acc: 0.9395
Epoch [16/50], Step [18212/18212], train_loss: 0.0153, train_acc: 0.9440, valid_loss: 0.0841, valid_acc: 0.9339
Epoch [17/50], Step [18212/18212], train_loss: 0.0153, train_acc: 0.9456, valid_loss: 0.1196, valid_acc: 0.8223
Epoch [18/50], Step [18212/18212], train_loss: 0.0153, train_acc: 0.9466, valid_loss: 0.1554, valid_acc: 0.8208
Epoch [19/50], Step [18212/18212], train_loss: 0.0170, train_acc: 0.9464, valid_loss: 0.0506, valid_acc: 0.9448
Epoch [20/50], Step [18212/18212], train_loss: 0.0240, train_acc: 0.9426, valid_loss: 0.0786, valid_acc: 0.9351
Epoch [21/50], Step [18212/18212], train_loss: 0.0157, train_acc: 0.9499, valid_loss: 0.0851, valid_acc: 0.8164
Epoch [22/50], Step [18212/18212], train_loss: 0.0153, train_acc: 0.9503, valid_loss: 0.0728, valid_acc: 0.8253
Epoch [23/50], Step [18212/18212], train_loss: 0.0152, train_acc: 0.9519, valid_loss: 0.0844, valid_acc: 0.9356
Epoch [24/50], Step [18212/18212], train_loss: 0.0151, train_acc: 0.9533, valid_loss: 0.1107, valid_acc: 0.8099
Epoch [25/50], Step [18212/18212], train_loss: 0.0150, train_acc: 0.9537, valid_loss: 0.0904, valid_acc: 0.9318
Epoch [26/50], Step [18212/18212], train_loss: 0.0149, train_acc: 0.9544, valid_loss: 0.0909, valid_acc: 0.9240
Epoch [27/50], Step [18212/18212], train_loss: 0.0148, train_acc: 0.9553, valid_loss: 0.0870, valid_acc: 0.8181
Epoch [28/50], Step [18212/18212], train_loss: 0.0148, train_acc: 0.9558, valid_loss: 0.1011, valid_acc: 0.8162
Epoch [29/50], Step [18212/18212], train_loss: 0.0148, train_acc: 0.9565, valid_loss: 0.0826, valid_acc: 0.9335
Epoch [30/50], Step [18212/18212], train_loss: 0.0149, train_acc: 0.9567, valid_loss: 0.0840, valid_acc: 0.8190
Epoch [31/50], Step [18212/18212], train_loss: 0.0147, train_acc: 0.9577, valid_loss: 0.0823, valid_acc: 0.8204
Epoch [32/50], Step [18212/18212], train_loss: 0.0147, train_acc: 0.9574, valid_loss: 0.0872, valid_acc: 0.8215
Epoch [33/50], Step [18212/18212], train_loss: 0.0147, train_acc: 0.9577, valid_loss: 0.0865, valid_acc: 0.9286
Epoch [34/50], Step [18212/18212], train_loss: 0.0148, train_acc: 0.9571, valid_loss: 0.0846, valid_acc: 0.8179
Epoch [35/50], Step [18212/18212], train_loss: 0.0146, train_acc: 0.9577, valid_loss: 0.0840, valid_acc: 0.9347
Epoch [36/50], Step [18212/18212], train_loss: 0.0147, train_acc: 0.9579, valid_loss: 0.1252, valid_acc: 0.8117
Epoch [37/50], Step [18212/18212], train_loss: 0.0145, train_acc: 0.9587, valid_loss: 0.1069, valid_acc: 0.8187
Epoch [38/50], Step [18212/18212], train_loss: 0.0145, train_acc: 0.9580, valid_loss: 0.0858, valid_acc: 0.8140
Epoch [39/50], Step [18212/18212], train_loss: 0.0146, train_acc: 0.9586, valid_loss: 0.1296, valid_acc: 0.8215
Epoch [40/50], Step [18212/18212], train_loss: 0.0146, train_acc: 0.9569, valid_loss: 0.0956, valid_acc: 0.8240
Epoch [41/50], Step [18212/18212], train_loss: 0.0147, train_acc: 0.9567, valid_loss: 0.0839, valid_acc: 0.9347
Epoch [42/50], Step [18212/18212], train_loss: 0.0145, train_acc: 0.9575, valid_loss: 0.0834, valid_acc: 0.9350
Epoch [43/50], Step [18212/18212], train_loss: 0.0145, train_acc: 0.9584, valid_loss: 0.0834, valid_acc: 0.8178
Epoch [44/50], Step [18212/18212], train_loss: 0.0150, train_acc: 0.9571, valid_loss: 0.1411, valid_acc: 0.8131
Epoch [45/50], Step [18212/18212], train_loss: 0.0145, train_acc: 0.9571, valid_loss: 0.0839, valid_acc: 0.8198
Epoch [46/50], Step [18212/18212], train_loss: 0.0144, train_acc: 0.9573, valid_loss: 0.0807, valid_acc: 0.9328
Epoch [47/50], Step [18212/18212], train_loss: 0.0145, train_acc: 0.9569, valid_loss: 0.0860, valid_acc: 0.9349
Epoch [48/50], Step [18212/18212], train_loss: 0.0145, train_acc: 0.9577, valid_loss: 0.0911, valid_acc: 0.9350
Epoch [49/50], Step [18212/18212], train_loss: 0.0144, train_acc: 0.9569, valid_loss: 0.1582, valid_acc: 0.9325
Epoch [50/50], Step [18212/18212], train_loss: 0.0144, train_acc: 0.9571, valid_loss: 0.0790, valid_acc: 0.8231
Finish training Pavia dataset
Save checkpoint to ./experiments/metric/checkpoints/classifier/Pavia
Start training PaviaU dataset
Epoch [1/50], Step [4473/4473], train_loss: 0.0971, train_acc: 0.7449, valid_loss: 0.2764, valid_acc: 0.5790
Epoch [2/50], Step [4473/4473], train_loss: 0.0506, train_acc: 0.8019, valid_loss: 0.3538, valid_acc: 0.5832
Epoch [3/50], Step [4473/4473], train_loss: 0.0298, train_acc: 0.8530, valid_loss: 0.3855, valid_acc: 0.5872
Epoch [4/50], Step [4473/4473], train_loss: 0.0191, train_acc: 0.8839, valid_loss: 0.3866, valid_acc: 0.7037
Epoch [5/50], Step [4473/4473], train_loss: 0.0165, train_acc: 0.9228, valid_loss: 0.4099, valid_acc: 0.5858
Epoch [6/50], Step [4473/4473], train_loss: 0.0157, train_acc: 0.9428, valid_loss: 0.3885, valid_acc: 0.5846
Epoch [7/50], Step [4473/4473], train_loss: 0.0151, train_acc: 0.9462, valid_loss: 0.4228, valid_acc: 0.5917
Epoch [8/50], Step [4473/4473], train_loss: 0.0149, train_acc: 0.9415, valid_loss: 0.4231, valid_acc: 0.7108
Epoch [9/50], Step [4473/4473], train_loss: 0.0147, train_acc: 0.9357, valid_loss: 0.4030, valid_acc: 0.5975
Epoch [10/50], Step [4473/4473], train_loss: 0.0144, train_acc: 0.9351, valid_loss: 0.4157, valid_acc: 0.5930
Epoch [11/50], Step [4473/4473], train_loss: 0.0142, train_acc: 0.9339, valid_loss: 0.4294, valid_acc: 0.7143
Epoch [12/50], Step [4473/4473], train_loss: 0.0144, train_acc: 0.9320, valid_loss: 0.4045, valid_acc: 0.5903
Epoch [13/50], Step [4473/4473], train_loss: 0.0142, train_acc: 0.9343, valid_loss: 0.4217, valid_acc: 0.5957
Epoch [14/50], Step [4473/4473], train_loss: 0.0142, train_acc: 0.9352, valid_loss: 0.4269, valid_acc: 0.7097
Epoch [15/50], Step [4473/4473], train_loss: 0.0140, train_acc: 0.9368, valid_loss: 0.4195, valid_acc: 0.7144
Epoch [16/50], Step [4473/4473], train_loss: 0.0140, train_acc: 0.9388, valid_loss: 0.4221, valid_acc: 0.5940
Epoch [17/50], Step [4473/4473], train_loss: 0.0140, train_acc: 0.9397, valid_loss: 0.4307, valid_acc: 0.5977
Epoch [18/50], Step [4473/4473], train_loss: 0.0138, train_acc: 0.9430, valid_loss: 0.4307, valid_acc: 0.7113
Epoch [19/50], Step [4473/4473], train_loss: 0.0140, train_acc: 0.9384, valid_loss: 0.4194, valid_acc: 0.7122
Epoch [20/50], Step [4473/4473], train_loss: 0.0140, train_acc: 0.9400, valid_loss: 0.4225, valid_acc: 0.7135
Epoch [21/50], Step [4473/4473], train_loss: 0.0136, train_acc: 0.9427, valid_loss: 0.4338, valid_acc: 0.7161
Epoch [22/50], Step [4473/4473], train_loss: 0.0138, train_acc: 0.9419, valid_loss: 0.4380, valid_acc: 0.5931
Epoch [23/50], Step [4473/4473], train_loss: 0.0137, train_acc: 0.9429, valid_loss: 0.4051, valid_acc: 0.6026
Epoch [24/50], Step [4473/4473], train_loss: 0.0146, train_acc: 0.9398, valid_loss: 0.3961, valid_acc: 0.5884
Epoch [25/50], Step [4473/4473], train_loss: 0.0136, train_acc: 0.9375, valid_loss: 0.4243, valid_acc: 0.7171
Epoch [26/50], Step [4473/4473], train_loss: 0.0136, train_acc: 0.9475, valid_loss: 0.4311, valid_acc: 0.7092
Epoch [27/50], Step [4473/4473], train_loss: 0.0136, train_acc: 0.9472, valid_loss: 0.3136, valid_acc: 0.5981
Epoch [28/50], Step [4473/4473], train_loss: 0.0136, train_acc: 0.9479, valid_loss: 0.4341, valid_acc: 0.5945
Epoch [29/50], Step [4473/4473], train_loss: 0.0135, train_acc: 0.9469, valid_loss: 0.4365, valid_acc: 0.5957
Epoch [30/50], Step [4473/4473], train_loss: 0.0135, train_acc: 0.9457, valid_loss: 0.4444, valid_acc: 0.7135
Epoch [31/50], Step [4473/4473], train_loss: 0.0134, train_acc: 0.9432, valid_loss: 0.4451, valid_acc: 0.5887
Epoch [32/50], Step [4473/4473], train_loss: 0.0135, train_acc: 0.9469, valid_loss: 0.4339, valid_acc: 0.7163
Epoch [33/50], Step [4473/4473], train_loss: 0.0134, train_acc: 0.9448, valid_loss: 0.4375, valid_acc: 0.7134
Epoch [34/50], Step [4473/4473], train_loss: 0.0134, train_acc: 0.9460, valid_loss: 0.4391, valid_acc: 0.5994
Epoch [35/50], Step [4473/4473], train_loss: 0.0134, train_acc: 0.9469, valid_loss: 0.4367, valid_acc: 0.7212
Epoch [36/50], Step [4473/4473], train_loss: 0.0134, train_acc: 0.9481, valid_loss: 0.4326, valid_acc: 0.7139
Epoch [37/50], Step [4473/4473], train_loss: 0.0133, train_acc: 0.9492, valid_loss: 0.4378, valid_acc: 0.7160
Epoch [38/50], Step [4473/4473], train_loss: 0.0134, train_acc: 0.9477, valid_loss: 0.4389, valid_acc: 0.7127
Epoch [39/50], Step [4473/4473], train_loss: 0.0139, train_acc: 0.9470, valid_loss: 0.4391, valid_acc: 0.7136
Epoch [40/50], Step [4473/4473], train_loss: 0.0133, train_acc: 0.9488, valid_loss: 0.4202, valid_acc: 0.5960
Epoch [41/50], Step [4473/4473], train_loss: 0.0134, train_acc: 0.9486, valid_loss: 0.4534, valid_acc: 0.7152
Epoch [42/50], Step [4473/4473], train_loss: 0.0138, train_acc: 0.9479, valid_loss: 0.4733, valid_acc: 0.5935
Epoch [43/50], Step [4473/4473], train_loss: 0.0133, train_acc: 0.9508, valid_loss: 0.4330, valid_acc: 0.7118
Epoch [44/50], Step [4473/4473], train_loss: 0.0134, train_acc: 0.9473, valid_loss: 0.4427, valid_acc: 0.7172
Epoch [45/50], Step [4473/4473], train_loss: 0.0132, train_acc: 0.9517, valid_loss: 0.4486, valid_acc: 0.7141
Epoch [46/50], Step [4473/4473], train_loss: 0.0134, train_acc: 0.9481, valid_loss: 0.4333, valid_acc: 0.7143
Epoch [47/50], Step [4473/4473], train_loss: 0.0136, train_acc: 0.9479, valid_loss: 0.4367, valid_acc: 0.5967
Epoch [48/50], Step [4473/4473], train_loss: 0.0132, train_acc: 0.9487, valid_loss: 0.4305, valid_acc: 0.6007
Epoch [49/50], Step [4473/4473], train_loss: 0.0133, train_acc: 0.9508, valid_loss: 0.4482, valid_acc: 0.7132
Epoch [50/50], Step [4473/4473], train_loss: 0.0133, train_acc: 0.9519, valid_loss: 0.4528, valid_acc: 0.5959
Finish training PaviaU dataset
Save checkpoint to ./experiments/metric/checkpoints/classifier/PaviaU
Start training Salinas_Corrected dataset
Epoch [1/50], Step [2237/2237], train_loss: 0.0676, train_acc: 0.7288, valid_loss: 0.1463, valid_acc: 0.5930
Epoch [2/50], Step [2237/2237], train_loss: 0.0537, train_acc: 0.7818, valid_loss: 0.1985, valid_acc: 0.5879
Epoch [3/50], Step [2237/2237], train_loss: 0.0402, train_acc: 0.8249, valid_loss: 0.1316, valid_acc: 0.6916
Epoch [4/50], Step [2237/2237], train_loss: 0.0362, train_acc: 0.8343, valid_loss: 0.0916, valid_acc: 0.5853
Epoch [5/50], Step [2237/2237], train_loss: 0.0403, train_acc: 0.8350, valid_loss: 0.1241, valid_acc: 0.5714
Epoch [6/50], Step [2237/2237], train_loss: 0.0480, train_acc: 0.8064, valid_loss: 0.1182, valid_acc: 0.5550
Epoch [7/50], Step [2237/2237], train_loss: 0.0472, train_acc: 0.8050, valid_loss: 0.1024, valid_acc: 0.7102
Epoch [8/50], Step [2237/2237], train_loss: 0.0501, train_acc: 0.8283, valid_loss: 0.1000, valid_acc: 0.7077
Epoch [9/50], Step [2237/2237], train_loss: 0.0505, train_acc: 0.8113, valid_loss: 0.0554, valid_acc: 0.8948
Epoch [10/50], Step [2237/2237], train_loss: 0.0392, train_acc: 0.8187, valid_loss: 0.0790, valid_acc: 0.8490
Epoch [11/50], Step [2237/2237], train_loss: 0.0419, train_acc: 0.8154, valid_loss: 0.0562, valid_acc: 0.7649
Epoch [12/50], Step [2237/2237], train_loss: 0.0430, train_acc: 0.8017, valid_loss: 0.1490, valid_acc: 0.6835
Epoch [13/50], Step [2237/2237], train_loss: 0.0379, train_acc: 0.8263, valid_loss: 0.0549, valid_acc: 0.7848
Epoch [14/50], Step [2237/2237], train_loss: 0.0328, train_acc: 0.8454, valid_loss: 0.0510, valid_acc: 0.9079
Epoch [15/50], Step [2237/2237], train_loss: 0.0490, train_acc: 0.7990, valid_loss: 0.0580, valid_acc: 0.8887
Epoch [16/50], Step [2237/2237], train_loss: 0.0432, train_acc: 0.8113, valid_loss: 0.0567, valid_acc: 0.7835
Epoch [17/50], Step [2237/2237], train_loss: 0.0380, train_acc: 0.8244, valid_loss: 0.0858, valid_acc: 0.8039
Epoch [18/50], Step [2237/2237], train_loss: 0.0406, train_acc: 0.8314, valid_loss: 0.0454, valid_acc: 0.9182
Epoch [19/50], Step [2237/2237], train_loss: 0.0330, train_acc: 0.8356, valid_loss: 0.1043, valid_acc: 0.6951
Epoch [20/50], Step [2237/2237], train_loss: 0.0390, train_acc: 0.8210, valid_loss: 0.0635, valid_acc: 0.7697
Epoch [21/50], Step [2237/2237], train_loss: 0.0499, train_acc: 0.7954, valid_loss: 0.1215, valid_acc: 0.6582
Epoch [22/50], Step [2237/2237], train_loss: 0.0352, train_acc: 0.8292, valid_loss: 0.0746, valid_acc: 0.8789
Epoch [23/50], Step [2237/2237], train_loss: 0.0314, train_acc: 0.8449, valid_loss: 0.0939, valid_acc: 0.8461
Epoch [24/50], Step [2237/2237], train_loss: 0.0463, train_acc: 0.8104, valid_loss: 0.1573, valid_acc: 0.7144
Epoch [25/50], Step [2237/2237], train_loss: 0.1247, train_acc: 0.5916, valid_loss: 0.1496, valid_acc: 0.5959
Epoch [26/50], Step [2237/2237], train_loss: 0.1111, train_acc: 0.6078, valid_loss: 0.1714, valid_acc: 0.6807
Epoch [27/50], Step [2237/2237], train_loss: 0.0983, train_acc: 0.6191, valid_loss: 0.1426, valid_acc: 0.5433
Epoch [28/50], Step [2237/2237], train_loss: 0.0758, train_acc: 0.7084, valid_loss: 0.1356, valid_acc: 0.5504
Epoch [29/50], Step [2237/2237], train_loss: 0.0699, train_acc: 0.7306, valid_loss: 0.1352, valid_acc: 0.7211
Epoch [30/50], Step [2237/2237], train_loss: 0.0703, train_acc: 0.7245, valid_loss: 0.1108, valid_acc: 0.5338
Epoch [31/50], Step [2237/2237], train_loss: 0.0952, train_acc: 0.6283, valid_loss: 0.0924, valid_acc: 0.6843
Epoch [32/50], Step [2237/2237], train_loss: 0.0729, train_acc: 0.7046, valid_loss: 0.0891, valid_acc: 0.5697
Epoch [33/50], Step [2237/2237], train_loss: 0.0589, train_acc: 0.7642, valid_loss: 0.0831, valid_acc: 0.6957
Epoch [34/50], Step [2237/2237], train_loss: 0.0530, train_acc: 0.7899, valid_loss: 0.1219, valid_acc: 0.7021
Epoch [35/50], Step [2237/2237], train_loss: 0.0709, train_acc: 0.7418, valid_loss: 0.0972, valid_acc: 0.5748
Epoch [36/50], Step [2237/2237], train_loss: 0.0661, train_acc: 0.7629, valid_loss: 0.0777, valid_acc: 0.6443
Epoch [37/50], Step [2237/2237], train_loss: 0.0509, train_acc: 0.8095, valid_loss: 0.0613, valid_acc: 0.7524
Epoch [38/50], Step [2237/2237], train_loss: 0.0781, train_acc: 0.6847, valid_loss: 0.1524, valid_acc: 0.6071
Epoch [39/50], Step [2237/2237], train_loss: 0.0590, train_acc: 0.7721, valid_loss: 0.0787, valid_acc: 0.6420
Epoch [40/50], Step [2237/2237], train_loss: 0.0461, train_acc: 0.8138, valid_loss: 0.0503, valid_acc: 0.7893
Epoch [41/50], Step [2237/2237], train_loss: 0.0721, train_acc: 0.7231, valid_loss: 0.0947, valid_acc: 0.5610
Epoch [42/50], Step [2237/2237], train_loss: 0.0573, train_acc: 0.7776, valid_loss: 0.1231, valid_acc: 0.5661
Epoch [43/50], Step [2237/2237], train_loss: 0.0573, train_acc: 0.7680, valid_loss: 0.1131, valid_acc: 0.5950
Epoch [44/50], Step [2237/2237], train_loss: 0.1238, train_acc: 0.6183, valid_loss: 0.1504, valid_acc: 0.6893
Epoch [45/50], Step [2237/2237], train_loss: 0.1336, train_acc: 0.5075, valid_loss: 0.1318, valid_acc: 0.5666
Epoch [46/50], Step [2237/2237], train_loss: 0.1272, train_acc: 0.5517, valid_loss: 0.1554, valid_acc: 0.5477
Epoch [47/50], Step [2237/2237], train_loss: 0.1473, train_acc: 0.5024, valid_loss: 0.1475, valid_acc: 0.5573
Epoch [48/50], Step [2237/2237], train_loss: 0.1191, train_acc: 0.5640, valid_loss: 0.1318, valid_acc: 0.5722
Epoch [49/50], Step [2237/2237], train_loss: 0.1296, train_acc: 0.5697, valid_loss: 0.1332, valid_acc: 0.7106
Epoch [50/50], Step [2237/2237], train_loss: 0.1162, train_acc: 0.5576, valid_loss: 0.1212, valid_acc: 0.5839
Finish training Salinas_Corrected dataset
Save checkpoint to ./experiments/metric/checkpoints/classifier/Salinas_Corrected
finish all datasets
