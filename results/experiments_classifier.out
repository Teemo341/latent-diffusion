Args:
	batch_size: 32
	checkpoint_dir: ./experiments/metric/checkpoints
	datasets: ['Indian_Pines_Corrected', 'KSC_Corrected', 'Pavia', 'PaviaU', 'Salinas_Corrected']
	embedding_dim: 256
	epochs: 50
	hidden_dim: 64
	image_size: 32
	layers: 16
	load_checkpoint: False
	lr: 0.0001
	save_checkpoint: True
Start training Indian_Pines_Corrected dataset
Save checkpoint to ./experiments/metric/checkpoints/classifier/Indian_Pines_Corrected
Epoch [1/50], Step [325/325], train_loss: 0.1061, train_acc: 0.7861, valid_loss: 0.1311, valid_acc: 0.6373, best_acc: 0.6373, early_stop_count: 0/5
Save checkpoint to ./experiments/metric/checkpoints/classifier/Indian_Pines_Corrected
Epoch [2/50], Step [325/325], train_loss: 0.0371, train_acc: 0.9461, valid_loss: 0.1268, valid_acc: 0.6862, best_acc: 0.6862, early_stop_count: 0/5
Epoch [3/50], Step [325/325], train_loss: 0.0183, train_acc: 0.9773, valid_loss: 0.1534, valid_acc: 0.6387, best_acc: 0.6862, early_stop_count: 1/5
Epoch [4/50], Step [325/325], train_loss: 0.0093, train_acc: 0.9913, valid_loss: 0.1517, valid_acc: 0.6739, best_acc: 0.6862, early_stop_count: 2/5
Save checkpoint to ./experiments/metric/checkpoints/classifier/Indian_Pines_Corrected
Epoch [5/50], Step [325/325], train_loss: 0.0062, train_acc: 0.9934, valid_loss: 0.1660, valid_acc: 0.7007, best_acc: 0.7007, early_stop_count: 0/5
Save checkpoint to ./experiments/metric/checkpoints/classifier/Indian_Pines_Corrected
Epoch [6/50], Step [325/325], train_loss: 0.0041, train_acc: 0.9965, valid_loss: 0.1543, valid_acc: 0.7349, best_acc: 0.7349, early_stop_count: 0/5
Save checkpoint to ./experiments/metric/checkpoints/classifier/Indian_Pines_Corrected
Epoch [7/50], Step [325/325], train_loss: 0.0035, train_acc: 0.9959, valid_loss: 0.1388, valid_acc: 0.7672, best_acc: 0.7672, early_stop_count: 0/5
Epoch [8/50], Step [325/325], train_loss: 0.0021, train_acc: 0.9983, valid_loss: 0.1433, valid_acc: 0.7616, best_acc: 0.7672, early_stop_count: 1/5
Save checkpoint to ./experiments/metric/checkpoints/classifier/Indian_Pines_Corrected
Epoch [9/50], Step [325/325], train_loss: 0.0025, train_acc: 0.9965, valid_loss: 0.1238, valid_acc: 0.8066, best_acc: 0.8066, early_stop_count: 0/5
Save checkpoint to ./experiments/metric/checkpoints/classifier/Indian_Pines_Corrected
Epoch [10/50], Step [325/325], train_loss: 0.0018, train_acc: 0.9979, valid_loss: 0.1294, valid_acc: 0.8112, best_acc: 0.8112, early_stop_count: 0/5
Save checkpoint to ./experiments/metric/checkpoints/classifier/Indian_Pines_Corrected
Epoch [11/50], Step [325/325], train_loss: 0.0017, train_acc: 0.9978, valid_loss: 0.1177, valid_acc: 0.8230, best_acc: 0.8230, early_stop_count: 0/5
Epoch [12/50], Step [325/325], train_loss: 0.0009, train_acc: 0.9993, valid_loss: 0.1707, valid_acc: 0.7476, best_acc: 0.8230, early_stop_count: 1/5
Epoch [13/50], Step [325/325], train_loss: 0.0021, train_acc: 0.9965, valid_loss: 0.1662, valid_acc: 0.7635, best_acc: 0.8230, early_stop_count: 2/5
Epoch [14/50], Step [325/325], train_loss: 0.0010, train_acc: 0.9989, valid_loss: 0.1670, valid_acc: 0.7425, best_acc: 0.8230, early_stop_count: 3/5
Epoch [15/50], Step [325/325], train_loss: 0.0012, train_acc: 0.9984, valid_loss: 0.1535, valid_acc: 0.7663, best_acc: 0.8230, early_stop_count: 4/5
Epoch [16/50], Step [325/325], train_loss: 0.0016, train_acc: 0.9974, valid_loss: 0.1653, valid_acc: 0.7251, best_acc: 0.8230, early_stop_count: 5/5
Early stop at epoch 15
Finish training Indian_Pines_Corrected dataset
Start training KSC_Corrected dataset
Save checkpoint to ./experiments/metric/checkpoints/classifier/KSC_Corrected
Epoch [1/50], Step [7011/7011], train_loss: 0.0218, train_acc: 0.9810, valid_loss: 0.0184, valid_acc: 0.9795, best_acc: 0.9795, early_stop_count: 0/5
Epoch [2/50], Step [7011/7011], train_loss: 0.0080, train_acc: 0.9847, valid_loss: 0.0193, valid_acc: 0.9792, best_acc: 0.9795, early_stop_count: 1/5
Epoch [3/50], Step [7011/7011], train_loss: 0.0053, train_acc: 0.9884, valid_loss: 0.0237, valid_acc: 0.9735, best_acc: 0.9795, early_stop_count: 2/5
Epoch [4/50], Step [7011/7011], train_loss: 0.0036, train_acc: 0.9928, valid_loss: 0.0228, valid_acc: 0.9785, best_acc: 0.9795, early_stop_count: 3/5
Epoch [5/50], Step [7011/7011], train_loss: 0.0028, train_acc: 0.9948, valid_loss: 0.0243, valid_acc: 0.9770, best_acc: 0.9795, early_stop_count: 4/5
Epoch [6/50], Step [7011/7011], train_loss: 0.0024, train_acc: 0.9955, valid_loss: 0.0234, valid_acc: 0.9777, best_acc: 0.9795, early_stop_count: 5/5
Early stop at epoch 5
Finish training KSC_Corrected dataset
Start training Pavia dataset
Save checkpoint to ./experiments/metric/checkpoints/classifier/Pavia
Epoch [1/50], Step [18212/18212], train_loss: 0.0618, train_acc: 0.8777, valid_loss: 0.0398, valid_acc: 0.9347, best_acc: 0.9347, early_stop_count: 0/5
Epoch [2/50], Step [18212/18212], train_loss: 0.0343, train_acc: 0.9279, valid_loss: 0.0587, valid_acc: 0.9223, best_acc: 0.9347, early_stop_count: 1/5
Epoch [3/50], Step [18212/18212], train_loss: 0.0160, train_acc: 0.9697, valid_loss: 0.0691, valid_acc: 0.9188, best_acc: 0.9347, early_stop_count: 2/5
Epoch [4/50], Step [18212/18212], train_loss: 0.0122, train_acc: 0.9770, valid_loss: 0.0744, valid_acc: 0.9201, best_acc: 0.9347, early_stop_count: 3/5
Epoch [5/50], Step [18212/18212], train_loss: 0.0224, train_acc: 0.9543, valid_loss: 0.0422, valid_acc: 0.9331, best_acc: 0.9347, early_stop_count: 4/5
Epoch [6/50], Step [18212/18212], train_loss: 0.0246, train_acc: 0.9503, valid_loss: 0.0707, valid_acc: 0.9192, best_acc: 0.9347, early_stop_count: 5/5
Early stop at epoch 5
Finish training Pavia dataset
Start training PaviaU dataset
Save checkpoint to ./experiments/metric/checkpoints/classifier/PaviaU
Epoch [1/50], Step [4473/4473], train_loss: 0.1053, train_acc: 0.8342, valid_loss: 0.2854, valid_acc: 0.6623, best_acc: 0.6623, early_stop_count: 0/5
Epoch [2/50], Step [4473/4473], train_loss: 0.0525, train_acc: 0.8870, valid_loss: 0.3621, valid_acc: 0.6555, best_acc: 0.6623, early_stop_count: 1/5
Epoch [3/50], Step [4473/4473], train_loss: 0.0294, train_acc: 0.9390, valid_loss: 0.3886, valid_acc: 0.6593, best_acc: 0.6623, early_stop_count: 2/5
Save checkpoint to ./experiments/metric/checkpoints/classifier/PaviaU
Epoch [4/50], Step [4473/4473], train_loss: 0.0117, train_acc: 0.9789, valid_loss: 0.3758, valid_acc: 0.6662, best_acc: 0.6662, early_stop_count: 0/5
Epoch [5/50], Step [4473/4473], train_loss: 0.0056, train_acc: 0.9911, valid_loss: 0.4544, valid_acc: 0.6615, best_acc: 0.6662, early_stop_count: 1/5
Save checkpoint to ./experiments/metric/checkpoints/classifier/PaviaU
Epoch [6/50], Step [4473/4473], train_loss: 0.0040, train_acc: 0.9939, valid_loss: 0.4686, valid_acc: 0.6667, best_acc: 0.6667, early_stop_count: 0/5
Save checkpoint to ./experiments/metric/checkpoints/classifier/PaviaU
Epoch [7/50], Step [4473/4473], train_loss: 0.0033, train_acc: 0.9950, valid_loss: 0.4613, valid_acc: 0.6766, best_acc: 0.6766, early_stop_count: 0/5
Epoch [8/50], Step [4473/4473], train_loss: 0.0026, train_acc: 0.9962, valid_loss: 0.4622, valid_acc: 0.6736, best_acc: 0.6766, early_stop_count: 1/5
Epoch [9/50], Step [4473/4473], train_loss: 0.0026, train_acc: 0.9963, valid_loss: 0.4759, valid_acc: 0.6756, best_acc: 0.6766, early_stop_count: 2/5
Epoch [10/50], Step [4473/4473], train_loss: 0.0024, train_acc: 0.9965, valid_loss: 0.4567, valid_acc: 0.6703, best_acc: 0.6766, early_stop_count: 3/5
Epoch [11/50], Step [4473/4473], train_loss: 0.0021, train_acc: 0.9971, valid_loss: 0.4750, valid_acc: 0.6758, best_acc: 0.6766, early_stop_count: 4/5
Epoch [12/50], Step [4473/4473], train_loss: 0.0020, train_acc: 0.9972, valid_loss: 0.4799, valid_acc: 0.6703, best_acc: 0.6766, early_stop_count: 5/5
Early stop at epoch 11
Finish training PaviaU dataset
Start training Salinas_Corrected dataset
Save checkpoint to ./experiments/metric/checkpoints/classifier/Salinas_Corrected
Epoch [1/50], Step [2237/2237], train_loss: 0.0504, train_acc: 0.8803, valid_loss: 0.0708, valid_acc: 0.8245, best_acc: 0.8245, early_stop_count: 0/5
Epoch [2/50], Step [2237/2237], train_loss: 0.0217, train_acc: 0.9325, valid_loss: 0.2345, valid_acc: 0.6852, best_acc: 0.8245, early_stop_count: 1/5
Save checkpoint to ./experiments/metric/checkpoints/classifier/Salinas_Corrected
Epoch [3/50], Step [2237/2237], train_loss: 0.0164, train_acc: 0.9479, valid_loss: 0.0602, valid_acc: 0.9010, best_acc: 0.9010, early_stop_count: 0/5
Epoch [4/50], Step [2237/2237], train_loss: 0.0133, train_acc: 0.9581, valid_loss: 0.1017, valid_acc: 0.8405, best_acc: 0.9010, early_stop_count: 1/5
Epoch [5/50], Step [2237/2237], train_loss: 0.0104, train_acc: 0.9672, valid_loss: 0.1258, valid_acc: 0.7113, best_acc: 0.9010, early_stop_count: 2/5
Epoch [6/50], Step [2237/2237], train_loss: 0.0078, train_acc: 0.9751, valid_loss: 0.2184, valid_acc: 0.6989, best_acc: 0.9010, early_stop_count: 3/5
Epoch [7/50], Step [2237/2237], train_loss: 0.0093, train_acc: 0.9709, valid_loss: 0.2176, valid_acc: 0.6573, best_acc: 0.9010, early_stop_count: 4/5
Epoch [8/50], Step [2237/2237], train_loss: 0.0064, train_acc: 0.9795, valid_loss: 0.0647, valid_acc: 0.8973, best_acc: 0.9010, early_stop_count: 5/5
Early stop at epoch 7
Finish training Salinas_Corrected dataset
finish all datasets
